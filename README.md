# å±±ä¸œçœæ€æ”¿è¯¾ä¸€ä½“åŒ–ä¸­å¿ƒ - å…¨æ ˆé¡¹ç›®

> åŸºäº Vue3 + TypeScript + Node.js + MongoDB æ„å»ºçš„ç°ä»£åŒ–æ€æ”¿æ•™è‚²å¹³å°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„å…¨æ ˆCMSåº”ç”¨ï¼ŒåŒ…å«å‰å°å±•ç¤ºç½‘ç«™å’Œç®¡ç†åå°ç³»ç»Ÿï¼Œæä¾›é›†æ–°é—»èµ„è®¯ã€æ•™å­¦èµ„æºã€åœ¨çº¿æ´»åŠ¨å’Œç”¨æˆ·æƒé™ç®¡ç†äºä¸€ä½“çš„æ€æ”¿æ•™è‚²å¹³å°ã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è§ˆ

| é¡¹ç›®ä¿¡æ¯     | å†…å®¹                                 |
| ------------ | ------------------------------------ |
| **é¡¹ç›®åç§°** | å±±ä¸œçœå¤§ä¸­å°å­¦æ€æ”¿è¯¾ä¸€ä½“åŒ–ä¸­å¿ƒå¹³å°   |
| **ç”Ÿäº§åŸŸå** | https://horsduroot.com               |
| **æœåŠ¡å™¨**   | é˜¿é‡Œäº‘ (60.205.124.67)               |
| **ç®¡ç†åå°** | https://horsduroot.com/admin         |
| **æ¶æ„ç±»å‹** | åŒå‰ç«¯ç³»ç»Ÿï¼ˆå…¬ä¼—å‰å° + ç®¡ç†åå°CMSï¼‰ |

## ğŸ—ï¸ æ ¸å¿ƒæŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯æ ˆ

- **æ ¸å¿ƒæ¡†æ¶**: Vue 3.5 + TypeScript 5.9
- **æ„å»ºå·¥å…·**: Vite 7.1 + ES Modules
- **UIç»„ä»¶åº“**: Element Plus + Ant Design Vue
- **çŠ¶æ€ç®¡ç†**: Pinia + æŒä¹…åŒ–
- **è·¯ç”±**: Vue Router 4.5ï¼ˆæƒé™æ§åˆ¶ï¼‰

### åç«¯æŠ€æœ¯æ ˆ

- **è¿è¡Œç¯å¢ƒ**: Node.js (ES Modules)
- **Webæ¡†æ¶**: Express 4.18
- **æ•°æ®åº“**: MongoDB + Mongoose 8.17
- **è®¤è¯**: JWT + bcrypt + è§’è‰²æƒé™ç³»ç»Ÿ
- **è¿›ç¨‹ç®¡ç†**: PM2

### åŸºç¡€è®¾æ–½

- **æ•°æ®åº“**: MongoDB (`sdszk` åº“å)
- **ç¼“å­˜**: Redis
- **WebæœåŠ¡å™¨**: Nginx (SSL + åå‘ä»£ç†)

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.x
- MongoDB >= 6.x
- Redis (å¯é€‰)

### ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒï¼ˆæ¨èï¼‰

**æ€»æ˜¯ä½¿ç”¨ä¸¤ä¸ªè„šæœ¬ä¼˜é›…çš„å…³é—­å’Œå¯åŠ¨å¼€å‘ç¯å¢ƒï¼Œé¿å…ç«¯å£å†²çªå’Œå­¤å„¿è¿›ç¨‹ã€‚**

```bash
# ğŸŸ¢ ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ
./scripts/development/dev-start.sh
# è‡ªåŠ¨å¯åŠ¨: MongoDBã€Redisã€åç«¯APIã€å‰ç«¯æœåŠ¡
# è®¿é—®: http://localhost:5173 (å‰ç«¯) | http://localhost:3000 (API)

# ğŸ”´ åœæ­¢å¼€å‘ç¯å¢ƒ
./scripts/development/dev-stop.sh
```

### æ‰‹åŠ¨å¯åŠ¨(ä¸æ¨è)

```bash
npm install                          # å®‰è£…å‰ç«¯ä¾èµ–
cd server && npm install && cd ..    # å®‰è£…åç«¯ä¾èµ–
npm run server:dev                   # å¯åŠ¨åç«¯ (localhost:3000)
npm run dev                          # å¯åŠ¨å‰ç«¯ (localhost:5173)
```

## ğŸ“Š ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼ˆå·²å®Œå–„ï¼‰

æœ¬é¡¹ç›®å·²å®Œæ•´å®ç°åŸºäºè§’è‰²çš„æƒé™ç®¡ç†ç³»ç»Ÿï¼ˆRBACï¼‰ï¼ŒåŒ…å«å®Œæ•´çš„ç”¨æˆ·ã€è§’è‰²ã€æƒé™ä¸‰çº§ç®¡ç†ã€‚

### ğŸ” æƒé™ç³»ç»Ÿæ¶æ„

- **æƒé™æ¨¡å‹**: `module:action` æ ¼å¼ï¼ˆå¦‚ `users:read`ï¼‰
- **è§’è‰²ç³»ç»Ÿ**: ç³»ç»Ÿç®¡ç†å‘˜ã€ç”¨æˆ·ç®¡ç†å‘˜ã€æŸ¥çœ‹è€…ç­‰é¢„å®šä¹‰è§’è‰²
- **æƒé™éªŒè¯**: å‰ç«¯æŒ‡ä»¤ + åç«¯ä¸­é—´ä»¶åŒé‡éªŒè¯

### ğŸ›ï¸ ç®¡ç†åå°åŠŸèƒ½

- **ç”¨æˆ·ç®¡ç†** (`/admin/users/list`): ç”¨æˆ·CRUDã€çŠ¶æ€ç®¡ç†ã€æ‰¹é‡æ“ä½œ
- **è§’è‰²ç®¡ç†** (`/admin/users/roles`): è§’è‰²é…ç½®ã€æƒé™åˆ†é…ã€ä½¿ç”¨ç»Ÿè®¡
- **æƒé™ç®¡ç†** (`/admin/users/permissions`): æƒé™æ ‘å±•ç¤ºã€æ¨¡å—åŒ–ç®¡ç†

### ğŸ—„ï¸ æ•°æ®åº“æ¨¡å‹

```javascript
// æ ¸å¿ƒæ¨¡å‹å·²å®Œæ•´å®ç°
User.js; // ç”¨æˆ·æ¨¡å‹ï¼ˆJWTè®¤è¯ã€è½¯åˆ é™¤ï¼‰
Role.js; // è§’è‰²æ¨¡å‹ï¼ˆæƒé™åˆ†é…ã€ç»Ÿè®¡åŠŸèƒ½ï¼‰
Permission.js; // æƒé™æ¨¡å‹ï¼ˆæ¨¡å—åŒ–ã€æƒé™æ ‘ï¼‰
```

### ğŸ”§ æƒé™åˆå§‹åŒ–

```bash
# æ•°æ®åº“å·²åŒ…å«åŸºç¡€æƒé™å’Œè§’è‰²
# å¦‚éœ€é‡ç½®ï¼Œè¿è¡Œï¼š
node scripts/database/init-roles-permissions.js
```

## ğŸ¢ ä¸šåŠ¡æ¨¡å—

### å†…å®¹ç®¡ç†

- **æ–°é—»ç³»ç»Ÿ**: ä¸­å¿ƒåŠ¨æ€ã€é€šçŸ¥å…¬å‘Šã€æ”¿ç­–æ–‡ä»¶ä¸‰å¤§åˆ†ç±»
- **èµ„æºç³»ç»Ÿ**: æ•™å­¦èµ„æºä¸Šä¼ ã€åˆ†ç±»ç®¡ç†ã€ç‰ˆæœ¬æ§åˆ¶
- **åˆ†ç±»ç®¡ç†**: åŠ¨æ€åˆ†ç±»ã€å±‚çº§ç»“æ„ã€æƒé™æ§åˆ¶

### ç”¨æˆ·äº¤äº’

- **è®¤è¯ç³»ç»Ÿ**: JWT + å¤šç»ˆç«¯ç™»å½•
- **è¡Œä¸ºè·Ÿè¸ª**: æµè§ˆå†å²ã€æ”¶è—ç®¡ç†ã€æ“ä½œæ—¥å¿—
- **æ–‡ä»¶ä¸Šä¼ **: å¤šæ ¼å¼æ”¯æŒã€å®‰å…¨éªŒè¯

## ğŸ“ é¡¹ç›®ç»“æ„

```
sdszk-redesign/
â”œâ”€â”€ src/                    # å‰ç«¯æºç 
â”‚   â”œâ”€â”€ views/             # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ News.vue      # å‰å°æ–°é—»
â”‚   â”‚   â””â”€â”€ admin/        # ç®¡ç†åå°
â”‚   â”œâ”€â”€ api/modules/       # APIå°è£…
â”‚   â”œâ”€â”€ stores/           # PiniaçŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ components/       # ç»„ä»¶åº“
â”œâ”€â”€ server/                # åç«¯æºç 
â”‚   â”œâ”€â”€ controllers/      # ä¸šåŠ¡æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/          # APIè·¯ç”±
â”‚   â””â”€â”€ middleware/      # ä¸­é—´ä»¶
â”œâ”€â”€ scripts/              # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ development/     # å¼€å‘ç¯å¢ƒ
â”‚   â”œâ”€â”€ deployment/      # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ database/        # æ•°æ®åº“ç®¡ç†
â””â”€â”€ docs/                # è¯¦ç»†æ–‡æ¡£
```

## ğŸš€ éƒ¨ç½²

**æ€»æ˜¯ä½¿ç”¨scripts/deploymentç›®å½•ä¸‹çš„è„šæœ¬è¿›è¡Œéƒ¨ç½²ï¼Œé¿å…é—æ¼æ­¥éª¤ã€‚**

### å‰ç«¯éƒ¨ç½²(å¯é€‰ï¼Œä¸æ¨è)

```bash
npm run build:aliyun      # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run deploy:aliyun     # éƒ¨ç½²åˆ°é˜¿é‡Œäº‘
```

### åç«¯éƒ¨ç½²(å¯é€‰ï¼Œä¸æ¨è)

```bash
npm run deploy:backend    # åç«¯æœåŠ¡éƒ¨ç½²
```

### ç¯å¢ƒé…ç½®

- **å¼€å‘ç¯å¢ƒ**: `.env.development` + `server/.env`
- **ç”Ÿäº§ç¯å¢ƒ**: `.env.aliyun` + `server/.env.production`

## ğŸ§ª æµ‹è¯•ä¸è´¨é‡

```bash
# æµ‹è¯•å¥—ä»¶
npm run test              # Vitestå•å…ƒæµ‹è¯•
npm run test:e2e          # Playwright E2Eæµ‹è¯•
npm run test:coverage     # æµ‹è¯•è¦†ç›–ç‡

# ä»£ç è´¨é‡
npm run lint              # ESLintæ£€æŸ¥
npm run format            # Prettieræ ¼å¼åŒ–
```

## ğŸ› ï¸ å¸¸ç”¨å¼€å‘å‘½ä»¤

```bash
# æ•°æ®åº“ç®¡ç†
npm run db:sync           # æ•°æ®åŒæ­¥
npm run db:tunnel         # SSHéš§é“è¿æ¥ç”Ÿäº§åº“

# ç¯å¢ƒè¯Šæ–­
./scripts/development/debug-services.sh      # å…¨é¢ç¯å¢ƒæ£€æŸ¥
./scripts/development/diagnose-backend.sh    # åç«¯æœåŠ¡è¯Šæ–­
./scripts/kill-ports.sh                      # æ¸…ç†ç«¯å£å ç”¨

# é¡¹ç›®ç»´æŠ¤
./scripts/development/cleanup-project.sh     # å®Œæ•´é¡¹ç›®æ¸…ç†
```

## ğŸ”— APIè·¯ç”±

### å‰å°API

```
/api/news                 # æ–°é—»èµ„è®¯
/api/resources            # æ•™å­¦èµ„æº
/api/auth                 # ç”¨æˆ·è®¤è¯
```

### ç®¡ç†åå°API

```
/api/admin/users          # ç”¨æˆ·ç®¡ç†
/api/admin/roles          # è§’è‰²ç®¡ç†
/api/admin/permissions    # æƒé™ç®¡ç†
/api/admin/news           # æ–°é—»ç®¡ç†
/api/admin/resources      # èµ„æºç®¡ç†
```

## ğŸ¤ å¼€å‘è§„èŒƒ

### Gitæäº¤è§„èŒƒ

```bash
feat: æ–°åŠŸèƒ½        fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°      style: æ ¼å¼è°ƒæ•´
refactor: é‡æ„      test: æµ‹è¯•
chore: æ„å»ºå·¥å…·     perf: æ€§èƒ½ä¼˜åŒ–
```

### ä»£ç è§„èŒƒ

- ES Modules (`"type": "module"`)
- TypeScriptä¸¥æ ¼æ¨¡å¼
- ESLint + Prettierè‡ªåŠ¨æ ¼å¼åŒ–
- Husky Git hooksè´¨é‡æ§åˆ¶

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

```bash
# ç«¯å£å†²çª
./scripts/kill-ports.sh

# æ•°æ®åº“è¿æ¥
brew services restart mongodb-community
redis-server --daemonize yes

# ä¾èµ–é—®é¢˜
rm -rf node_modules package-lock.json
npm install
```

### éªŒè¯ç¯å¢ƒ

```bash
# å¼€å‘ç¯å¢ƒ
curl http://localhost:5173
curl http://localhost:3000/api/health

# ç”Ÿäº§ç¯å¢ƒ
curl https://horsduroot.com/api/health
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- ğŸ“‚ [docs/](./docs/) - è¯¦ç»†æ¶æ„æ–‡æ¡£
- ğŸ”§ [scripts/](./scripts/) - è‡ªåŠ¨åŒ–è„šæœ¬

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

_æœ€åçš„å¼ºè°ƒ_

1. æ€»æ˜¯ä½¿ç”¨è„šæœ¬ä¼˜é›…çš„å…³é—­å’Œå¯åŠ¨å¼€å‘ç¯å¢ƒï¼Œé¿å…ç«¯å£å†²çªå’Œå­¤å„¿è¿›ç¨‹ã€‚
2. æ€»æ˜¯ä½¿ç”¨scripts/deploymentç›®å½•ä¸‹çš„è„šæœ¬è¿›è¡Œéƒ¨ç½²ï¼Œé¿å…é—æ¼æ­¥éª¤

---
