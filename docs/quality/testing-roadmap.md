---
title: 测试演进路线图
updated: 2025-09-29
status: draft
owner: qa-team
---

# 测试演进路线图

结合 `testing-baseline.md` 现状与 `testing-strategy.md` 目标，按阶段推进。各阶段结束需产出：覆盖率快照 + 风险复评 + 阻塞清单。

## 🗺️ 阶段概览

| 阶段    | 时间窗口 | 目标         | 覆盖率里程碑 | 核心交付                     |
| ------- | -------- | ------------ | ------------ | ---------------------------- |
| Phase 0 | Week 0   | 恢复健康     | ~5% → 15%    | 修复失败用例 + API 核心单测  |
| Phase 1 | Week 1-2 | 业务主干防护 | 15% → 40%    | 关键组件 + 登录/新闻/资源流  |
| Phase 2 | Week 3-4 | 全面覆盖骨架 | 40% → 65%    | 页面级 + 工作流 E2E + 服务层 |
| Phase 3 | Week 5-6 | 质量门禁成型 | 65% → 75%    | 门禁策略固化 + 波动监控      |
| Phase 4 | Week 7-8 | 优化与增强   | 75% → 85%+   | 性能 / a11y / 边界与异常     |

> 任何阶段若新增高风险模块（权限 / 上传 / 缓存），需即时插入“热补”小循环。

## 🧨 Phase 0 详述（恢复健康）

| 任务             | 描述                              | 验收                      |
| ---------------- | --------------------------------- | ------------------------- |
| 修复失败用例     | api / logger / performance        | CI 全绿                   |
| API 核心         | news / resources / user 模块方法  | 每接口：成功 + 错误用例   |
| Composables 基础 | usePermission / useRecentlyViewed | 核心分支覆盖 > 80%        |
| 基础脚手架       | 测试命令封装 / watch 快捷         | `npm run test:unit` < 30s |

## 🧱 Phase 1（主干防护）

| 主题     | 覆盖范围                   | 输出                     |
| -------- | -------------------------- | ------------------------ |
| 关键组件 | 登录 / 表单 / Table / 上传 | 行为驱动用例 (交互+验证) |
| 集成流程 | 登录→发布新闻→查看列表     | 集成脚本 1 套            |
| 缓存失效 | SiteSetting 更新流         | 失效 + 回填断言          |
| 权限路径 | RBAC 典型矩阵              | 角色 × 动作断言集        |

## 🌐 Phase 2（全面骨架）

| 主题         | 目标                  | 输出                       |
| ------------ | --------------------- | -------------------------- |
| 页面级测试   | Admin + 用户主路径    | 关键视图渲染 + 路由守卫    |
| E2E 工作流   | 用户旅程 3 条         | Playwright 脚本 + 截图证据 |
| 服务层       | 缓存 / 通知 / 转换    | Service 粒度单测套件       |
| 数据工厂扩展 | news/resource/setting | factory 统一入口           |

## 🛡️ Phase 3（门禁成型）

| 主题         | 目标         | 输出                      |
| ------------ | ------------ | ------------------------- |
| 覆盖波动控制 | 覆盖率不下降 | 覆盖差异报告自动评论      |
| Flaky 收敛   | 0 flaky      | 重试统计面板 + 黑名单清空 |
| 静态质量门槛 | PR 阈值 75%  | GitHub Action 规则固化    |
| 报告可视化   | 趋势图       | 7/14/30 日曲线            |

## 🚀 Phase 4（优化增强）

| 主题       | 目标                     | 输出                    |
| ---------- | ------------------------ | ----------------------- |
| 性能基线   | 关键组件渲染 < 100ms     | 性能快照 / 回归检测脚本 |
| 内存与泄漏 | 大批量 mount 稳定        | 泄漏检测用例            |
| 可访问性   | a11y 关键页面 0 严重违规 | axe 集成脚本            |
| 边界/异常  | 失败路径全覆盖           | Error Matrix 用例       |

## 🔧 工具与自动化节点

| 节点     | 工具                | 说明                |
| -------- | ------------------- | ------------------- |
| 基础执行 | Vitest / Playwright | 单元 & E2E 分离并行 |
| Mock     | MSW                 | 统一网络模拟入口    |
| 覆盖率   | v8 provider         | 差异生成 JSON       |
| 报告     | Codecov / 自托管    | PR 注释 + 趋势图    |
| a11y     | axe-core (后期)     | 在 E2E 中注入       |

## 📊 指标监控集成 (建议)

| 指标       | 采集        | 展示            |
| ---------- | ----------- | --------------- |
| 覆盖率     | CI 任务     | Codecov / Badge |
| 执行时长   | CI Log 分析 | 周报 / 趋势图   |
| Flaky 次数 | 重试统计    | 月度汇总        |
| 失败率     | 测试结果    | 触发警报        |

## 🔄 变更管理

- 任何阶段调整需：记录 → 公布 → 更新 roadmap 版本号
- 重大偏移（>2 周）需重新定义里程碑与优先级

## 🚫 反模式预警

| 反模式           | 说明            | 缓解                   |
| ---------------- | --------------- | ---------------------- |
| 只追求覆盖率数字 | 行为断言缺失    | 引入用例审查 Checklist |
| 大量 snapshot    | 难以维护 / 噪音 | 精简到结构性断言       |
| Mock 过度        | 行为脱离真实    | 提供“最小 Mock”示例库  |

## ✅ 验收标准

阶段完成 = 指标达成 + 交付物就绪 + 风险复评通过。

---

如阶段提前完成，可提前拉取下一阶段的高风险子集（权限/缓存/上传）。
