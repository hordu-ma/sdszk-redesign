#!/bin/bash

echo "ğŸ›‘ åœæ­¢å±±ä¸œçœæ€æ”¿è¯¾ä¸€ä½“åŒ–ä¸­å¿ƒå¼€å‘ç¯å¢ƒ..."

# åœæ­¢å‰ç«¯å¼€å‘æœåŠ¡å™¨ (é€šå¸¸åœ¨ 5173 ç«¯å£)
echo "ğŸŒ åœæ­¢å‰ç«¯å¼€å‘æœåŠ¡å™¨..."
lsof -ti:5173 | xargs kill -9 2>/dev/null && echo "âœ… å‰ç«¯æœåŠ¡å™¨å·²åœæ­¢" || echo "â„¹ï¸  å‰ç«¯æœåŠ¡å™¨æœªè¿è¡Œ"

# åœæ­¢åç«¯æœåŠ¡å™¨ (é€šå¸¸åœ¨ 3000 ç«¯å£)
echo "ğŸ–¥ï¸  åœæ­¢åç«¯æœåŠ¡å™¨..."
lsof -ti:3000 | xargs kill -9 2>/dev/null && echo "âœ… åç«¯æœåŠ¡å™¨å·²åœæ­¢" || echo "â„¹ï¸  åç«¯æœåŠ¡å™¨æœªè¿è¡Œ"

# è¯¢é—®æ˜¯å¦åœæ­¢ Redis
echo ""
if pgrep -f redis-server > /dev/null; then
    read -p "â“ æ£€æµ‹åˆ° Redis æ­£åœ¨è¿è¡Œï¼Œæ˜¯å¦åœæ­¢? (y/N): " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        pkill -f redis-server
        echo "âœ… Redis æœåŠ¡å™¨å·²åœæ­¢"
    else
        echo "ğŸ“Š Redis æœåŠ¡å™¨ä¿æŒè¿è¡ŒçŠ¶æ€"
    fi
else
    echo "â„¹ï¸  Redis æœåŠ¡å™¨æœªè¿è¡Œ"
fi

echo "ğŸ‰ å¼€å‘ç¯å¢ƒåœæ­¢å®Œæˆï¼"
